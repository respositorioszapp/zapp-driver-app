{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { Capacitor } from '@capacitor/core'; // import { BackgroundGeolocation, BackgroundGeolocationAuthorizationStatus } from '@ionic-native/background-geolocation/ngx';\n\nimport BackgroundGeolocation from \"cordova-background-geolocation-lt\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/ui.service\";\nimport * as i2 from \"@ionic/angular\";\nimport * as i3 from \"src/app/services/auth.service\";\nexport let RequestLocationPermissionPage = /*#__PURE__*/(() => {\n  class RequestLocationPermissionPage {\n    constructor(ui, platform, // private backgroundGeolocation: BackgroundGeolocation,\n    auth) {\n      this.ui = ui;\n      this.platform = platform;\n      this.auth = auth;\n      this.platform = platform;\n    }\n\n    ngOnInit() {}\n\n    denie() {\n      if (Capacitor.platform !== 'web') {\n        // App.exitApp()\n        try {\n          this.auth.logOut();\n          navigator['app'].exitApp();\n        } catch (e) {\n          console.log(\"Error closing app\", e);\n        }\n      } else {\n        this.dismiss();\n      }\n    }\n\n    accept() {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.dismiss();\n        localStorage.setItem(\"background_location_accepted\", \"accepted\");\n\n        try {\n          const status = yield BackgroundGeolocation.requestPermission();\n\n          if (status == 2) {\n            yield this.ui.presentAlert({\n              mode: 'ios',\n              header: '¡Advertencia!',\n              message: 'Si la aplicación no tiene perimisos para obtener su ubicación, no podrá tener un correcto funcionamiento',\n              buttons: [{\n                text: 'Aceptar',\n                role: 'cancel',\n                cssClass: 'secondary',\n                handler: blah => {\n                  console.log(\"Execute\");\n                }\n              }]\n            });\n          } else {\n            if (status == 3) {\n              let isIgnoring = yield BackgroundGeolocation.deviceSettings.isIgnoringBatteryOptimizations();\n\n              if (!isIgnoring) {\n                BackgroundGeolocation.deviceSettings.showIgnoreBatteryOptimizations().then(request => {\n                  console.log(`- Screen seen? ${request.seen} ${request.lastSeenAt}`);\n                  console.log(`- Device: ${request.manufacturer} ${request.model} ${request.version}`); // If we've already shown this screen to the user, we don't want to annoy them.\n                  // if (request.seen) {\n                  //   return;\n                  // }\n\n                  BackgroundGeolocation.deviceSettings.show(request); // It's your responsibility to instruct the user what exactly\n                  // to do here, perhaps with a Confirm Dialog:\n                }).catch(error => {\n                  // Depending on Manufacturer/Model/OS Version, a Device may not implement\n                  // a particular Settings screen.\n                  console.warn(error);\n                });\n              } // User clicked [Confirm] button.  Execute the redirect to settings screen:\n\n            } else {}\n          }\n        } catch (e) {// this.ui.showToast(\"Hubo un error con Background \" + JSON.stringify(e));\n        }\n      });\n    }\n\n    dismiss() {\n      this.ui.dismiss();\n    }\n\n  }\n\n  RequestLocationPermissionPage.ɵfac = function RequestLocationPermissionPage_Factory(t) {\n    return new (t || RequestLocationPermissionPage)(i0.ɵɵdirectiveInject(i1.UiService), i0.ɵɵdirectiveInject(i2.Platform), i0.ɵɵdirectiveInject(i3.AuthService));\n  };\n\n  RequestLocationPermissionPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: RequestLocationPermissionPage,\n    selectors: [[\"app-request-location-permission\"]],\n    inputs: {\n      request: \"request\"\n    },\n    decls: 23,\n    vars: 0,\n    consts: [[1, \"advice\"], [1, \"ion-text-center\"], [1, \"ion-text-center\", \"grey-color\"], [1, \"ion-text-center\", \"terms-and-conditions\"], [1, \"grey-color\"], [\"href\", \"https://www.zapplogistica.com/privacy\", \"target\", \"_blank\", \"rel\", \"noopener noreferrer\", \"color\", \"primary\", 1, \"ion-margin-top\", \"ion-text-center\"], [\"src\", \"assets/imgs/express-courier-2.png\", \"alt\", \"\", 1, \"img-courrier\"], [\"expand\", \"full\", 1, \"button\", \"denie\", 3, \"click\"], [\"expand\", \"full\", 1, \"button\", \"accept\", 3, \"click\"]],\n    template: function RequestLocationPermissionPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-content\")(1, \"div\", 0)(2, \"h4\", 1);\n        i0.ɵɵtext(3, \"\\u00A1Aviso importante!\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"p\", 2);\n        i0.ɵɵtext(5, \"Esta aplicaci\\u00F3n recopila datos de ubicaci\\u00F3n para habilitar el seguimiento del mensajero en tiempo real, incluso cuando la aplicaci\\u00F3n est\\u00E1 cerrada o no est\\u00E1 en uso. Para un correcto funcionamiento en dispositivos Android 10 o superior, recomendamos tener la ubicaci\\u00F3n encendida con los permisos de ubicaci\\u00F3n todo el tiempo e ignorando la optimizaci\\u00F3n de la bater\\u00EDa \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(6, \"div\", 3)(7, \"p\", 4);\n        i0.ɵɵtext(8, \"Al hacer clic en \\\"Aceptar\\\", aceptas nuestras \");\n        i0.ɵɵelementStart(9, \"a\", 5);\n        i0.ɵɵtext(10, \"condiciones\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(11, \", la \");\n        i0.ɵɵelementStart(12, \"a\", 5);\n        i0.ɵɵtext(13, \"Pol\\u00EDtica de datos\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(14, \" y la \");\n        i0.ɵɵelementStart(15, \"a\", 5);\n        i0.ɵɵtext(16, \"Pol\\u00EDtica de cookies\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(17, \". \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(18, \"img\", 6);\n        i0.ɵɵelementStart(19, \"ion-button\", 7);\n        i0.ɵɵlistener(\"click\", function RequestLocationPermissionPage_Template_ion_button_click_19_listener() {\n          return ctx.denie();\n        });\n        i0.ɵɵtext(20, \" DENEGAR \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"ion-button\", 8);\n        i0.ɵɵlistener(\"click\", function RequestLocationPermissionPage_Template_ion_button_click_21_listener() {\n          return ctx.accept();\n        });\n        i0.ɵɵtext(22, \"Aceptar\");\n        i0.ɵɵelementEnd()();\n      }\n    },\n    dependencies: [i2.IonButton, i2.IonContent],\n    styles: [\".advice[_ngcontent-%COMP%]{position:absolute;top:23px}.terms-and-conditions[_ngcontent-%COMP%]{position:absolute;right:0;left:0;bottom:100px}.terms-and-conditions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#1c024b}.img-courrier[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;margin:auto;width:300px;height:200px}ion-button.button[_ngcontent-%COMP%]{position:absolute;bottom:0;width:50%}ion-button.button.denie[_ngcontent-%COMP%]{--background: white;color:#21c1ff}ion-button.button.accept[_ngcontent-%COMP%]{right:0;--background: #21c1ff}\"]\n  });\n  return RequestLocationPermissionPage;\n})();","map":null,"metadata":{},"sourceType":"module"}