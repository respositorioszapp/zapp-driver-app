{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { ViewDetailPage } from 'src/app/screens/forms/view-detail/view-detail.page';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/ui.service\";\nimport * as i2 from \"src/app/services/request.service\";\nimport * as i3 from \"src/app/services/auth.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"src/app/services/network-status.service\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@ionic/angular\";\nimport * as i8 from \"../../../pipes/date-local.pipe\";\n\nfunction HistoryPage_ng_container_5_ion_card_1_div_51_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15)(1, \"div\", 13)(2, \"p\", 16);\n    i0.ɵɵtext(3, \" N\\u00FAmero de horas : \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"div\", 17)(5, \"strong\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const item_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(item_r5.number_hours);\n  }\n}\n\nfunction HistoryPage_ng_container_5_ion_card_1_ng_container_54_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1);\n    i0.ɵɵelement(2, \"ion-icon\", 23);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const item_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", item_r5.score_service ? item_r5.score_service : 0, \"\");\n  }\n}\n\nfunction HistoryPage_ng_container_5_ion_card_1_ng_template_55_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \" Sin calificar \");\n    i0.ɵɵelement(1, \"ion-icon\", 24);\n  }\n}\n\nfunction HistoryPage_ng_container_5_ion_card_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"ion-card\", 10)(1, \"ion-card-content\", 11);\n    i0.ɵɵlistener(\"click\", function HistoryPage_ng_container_5_ion_card_1_Template_ion_card_content_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r13);\n      const item_r5 = restoredCtx.$implicit;\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r12.viewDetail(item_r5));\n    });\n    i0.ɵɵelementStart(2, \"div\", 12)(3, \"div\", 13);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 14);\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"titlecase\");\n    i0.ɵɵpipe(8, \"dateLocal\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 15)(10, \"div\", 13)(11, \"p\", 16);\n    i0.ɵɵtext(12, \"Tipo de Servicio : \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"div\", 17)(14, \"strong\");\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(16, \"div\", 15)(17, \"div\", 13)(18, \"p\", 16);\n    i0.ɵɵtext(19, \" Ciudad : \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(20, \"div\", 17)(21, \"strong\");\n    i0.ɵɵtext(22);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(23, \"div\", 15)(24, \"div\", 13)(25, \"p\", 16);\n    i0.ɵɵtext(26, \" Cantidad : \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(27, \"div\", 13)(28, \"strong\");\n    i0.ɵɵtext(29);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(30, \"div\", 15)(31, \"div\", 13)(32, \"p\", 16);\n    i0.ɵɵtext(33, \" Recorrido : \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(34, \"div\", 17)(35, \"strong\");\n    i0.ɵɵtext(36);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(37, \"div\", 15)(38, \"div\", 13)(39, \"p\", 16);\n    i0.ɵɵtext(40, \" Valor declarado : \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(41, \"div\", 13)(42, \"strong\");\n    i0.ɵɵtext(43);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(44, \"div\", 15)(45, \"div\", 13)(46, \"p\", 16);\n    i0.ɵɵtext(47, \" Tipo de accesorio : \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(48, \"div\", 13)(49, \"strong\");\n    i0.ɵɵtext(50);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(51, HistoryPage_ng_container_5_ion_card_1_div_51_Template, 7, 1, \"div\", 18);\n    i0.ɵɵelementStart(52, \"ion-item\", 19)(53, \"ion-button\", 20);\n    i0.ɵɵtemplate(54, HistoryPage_ng_container_5_ion_card_1_ng_container_54_Template, 3, 1, \"ng-container\", 4);\n    i0.ɵɵtemplate(55, HistoryPage_ng_container_5_ion_card_1_ng_template_55_Template, 2, 0, \"ng-template\", null, 21, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(57, \"ion-button\", 22);\n    i0.ɵɵtext(58);\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const item_r5 = ctx.$implicit;\n\n    const _r8 = i0.ɵɵreference(56);\n\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" ORDEN #\", item_r5.id, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(7, 14, i0.ɵɵpipeBind1(8, 16, item_r5.date)), \" \");\n    i0.ɵɵadvance(9);\n    i0.ɵɵtextInterpolate(item_r5.service_type);\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate(item_r5.city);\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate(item_r5.details.length);\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate(item_r5.round_trip == 1 ? \"Ida y Vuelta\" : \"Ida\");\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate(item_r5.declared_value);\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate(item_r5.accessory_type);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", item_r5.service_type_id == 3);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", item_r5.score_service)(\"ngIfElse\", _r8);\n    i0.ɵɵadvance(3);\n    i0.ɵɵclassMap(ctx_r3.store_states[item_r5.status_order].class);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r3.store_states[item_r5.status_order].message, \" \");\n  }\n}\n\nfunction HistoryPage_ng_container_5_ion_card_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\")(1, \"ion-card-content\")(2, \"div\", 12)(3, \"div\", 13);\n    i0.ɵɵelement(4, \"ion-skeleton-text\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 14);\n    i0.ɵɵelement(6, \"ion-skeleton-text\", 25);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 26)(8, \"div\", 13);\n    i0.ɵɵelement(9, \"ion-skeleton-text\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 27);\n    i0.ɵɵelement(11, \"ion-skeleton-text\", 25);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"div\", 26)(13, \"div\", 13);\n    i0.ɵɵelement(14, \"ion-skeleton-text\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"div\", 27);\n    i0.ɵɵelement(16, \"ion-skeleton-text\", 25);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"div\", 26)(18, \"div\", 13);\n    i0.ɵɵelement(19, \"ion-skeleton-text\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"div\", 27);\n    i0.ɵɵelement(21, \"ion-skeleton-text\", 25);\n    i0.ɵɵelementEnd()()()();\n  }\n}\n\nfunction HistoryPage_ng_container_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, HistoryPage_ng_container_5_ion_card_1_Template, 59, 18, \"ion-card\", 6);\n    i0.ɵɵtemplate(2, HistoryPage_ng_container_5_ion_card_2_Template, 22, 0, \"ion-card\", 7);\n    i0.ɵɵelementStart(3, \"ion-infinite-scroll\", 8);\n    i0.ɵɵlistener(\"ionInfinite\", function HistoryPage_ng_container_5_Template_ion_infinite_scroll_ionInfinite_3_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.loadData($event));\n    });\n    i0.ɵɵelement(4, \"ion-infinite-scroll-content\", 9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.orders);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.loading);\n  }\n}\n\nfunction HistoryPage_ng_template_6_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29)(1, \"h3\", 30);\n    i0.ɵɵtext(2, \"No ha realizado ning\\u00FAn viaje\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction HistoryPage_ng_template_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, HistoryPage_ng_template_6_div_0_Template, 3, 0, \"div\", 28);\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.orders.length == 0);\n  }\n}\n\nexport let HistoryPage = /*#__PURE__*/(() => {\n  class HistoryPage {\n    constructor(ui, request, auth, router, network) {\n      this.ui = ui;\n      this.request = request;\n      this.auth = auth;\n      this.router = router;\n      this.network = network;\n      this.orders = [];\n      this.image = \"assets/imgs/avatar.svg\";\n      this.slideOpts = {\n        initialSlide: 1,\n        speed: 400\n      };\n      this.store_states = {\n        25: {\n          message: \"Finalizada\",\n          state: 25,\n          class: \"button-green\"\n        },\n        31: {\n          message: \"Cancelada\",\n          state: 31,\n          color: \"button-cancel\"\n        },\n        36: {\n          message: \"Cancelada por mensajero\",\n          state: 36,\n          color: \"button-gray \"\n        },\n        48: {\n          message: \"Orden no efectiva\",\n          state: 48,\n          color: \"button-dark\"\n        }\n      };\n      this.allLoaded = false;\n      this.dataParams = {\n        total: 0,\n        per_page: 5,\n        page: 1,\n        filters: []\n      };\n      this.nextPage = \"\";\n      this.to = 0;\n      this.loadedText = \"\";\n      this.loading = false;\n    }\n\n    ngOnInit() {}\n\n    ionViewWillEnter() {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.user = this.auth.user;\n        this.dataParams.page = 1;\n\n        if (this.network.getNetworkStatus().connected) {\n          const loader = yield this.ui.loading(\"Por favor espere...\");\n          this.request.get(`driver/history_services/${this.auth.user.id}?per_page=${this.dataParams.per_page}&page=${this.dataParams.page}`).subscribe(res => __awaiter(this, void 0, void 0, function* () {\n            (yield loader).dismiss();\n            console.log(\"Res\", res.data.data);\n            this.orders = res.data.data;\n            this.to = res.data.to;\n          }), err => __awaiter(this, void 0, void 0, function* () {\n            (yield loader).dismiss();\n            this.orders = [];\n          }));\n        } else {\n          this.ui.showToast(\"Verifique su conexión\");\n        }\n      });\n    }\n\n    viewDetail(order) {\n      return __awaiter(this, void 0, void 0, function* () {\n        if (this.network.getNetworkStatus().connected) {\n          if (order.status_order == 23) {\n            yield this.ui.presentAlert({\n              mode: 'ios',\n              header: '¿Quieres iniciar el viaje?',\n              buttons: [{\n                text: 'No',\n                role: 'cancel',\n                cssClass: 'secondary',\n                handler: blah => {\n                  console.log('Confirm Cancel: blah');\n                }\n              }, {\n                text: 'Sí',\n                handler: () => __awaiter(this, void 0, void 0, function* () {\n                  const modal = yield this.ui.presentModal(ViewDetailPage, {\n                    order\n                  });\n                  const m = yield modal.onDidDismiss();\n                  this.dataParams.page = 1;\n                  this.ionViewWillEnter();\n                })\n              }]\n            });\n          } else {\n            const modal = yield this.ui.presentModal(ViewDetailPage, {\n              order\n            });\n            const m = yield modal.onDidDismiss();\n            this.dataParams.page = 1;\n            this.ionViewWillEnter();\n          }\n        } else {\n          this.ui.showToast(\"Verifique su conexión\");\n        }\n      });\n    }\n\n    loadData(event) {\n      if (this.network.getNetworkStatus().connected) {\n        this.dataParams.page++;\n        this.loading = true;\n        this.request.get(`driver/history_services/${this.auth.user.id}?per_page=${this.dataParams.per_page}&page=${this.dataParams.page}`).subscribe(res => __awaiter(this, void 0, void 0, function* () {\n          console.log(\"Sucesss\");\n          res.data.data.map(d => {\n            this.orders.push(d);\n          });\n          console.log(\"Orders\", this.orders);\n          this.loading = false;\n          event.target.complete();\n        }), err => __awaiter(this, void 0, void 0, function* () {\n          console.log(\"Error\");\n          event.target.disabled = true;\n          this.allLoaded = true;\n          this.loading = false;\n          console.log(\"Error\", err);\n          err.error.data.map(d => {\n            this.orders.push(d);\n          });\n          event.target.complete();\n        }));\n      } else {\n        this.ui.showToast(\"Verifique su conexión\");\n      }\n    }\n\n  }\n\n  HistoryPage.ɵfac = function HistoryPage_Factory(t) {\n    return new (t || HistoryPage)(i0.ɵɵdirectiveInject(i1.UiService), i0.ɵɵdirectiveInject(i2.RequestService), i0.ɵɵdirectiveInject(i3.AuthService), i0.ɵɵdirectiveInject(i4.Router), i0.ɵɵdirectiveInject(i5.NetworkStatusService));\n  };\n\n  HistoryPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: HistoryPage,\n    selectors: [[\"app-history\"]],\n    decls: 8,\n    vars: 2,\n    consts: [[\"color\", \"warning\"], [2, \"padding\", \"0\", \"min-height\", \"350px\"], [2, \"padding\", \"0\"], [1, \"ion-text-center\"], [4, \"ngIf\", \"ngIfElse\"], [\"elseTemplateOrder\", \"\"], [\"style\", \"margin-bottom: 10px;\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [3, \"ionInfinite\"], [\"loadingSpinner\", \"bubbles\"], [2, \"margin-bottom\", \"10px\"], [3, \"click\"], [2, \"width\", \"100%\", \"display\", \"flex\"], [1, \"w-50\"], [2, \"width\", \"50%\", \"text-align\", \"right\"], [1, \"row\"], [1, \"\"], [2, \"width\", \"50%\"], [\"class\", \"row\", 4, \"ngIf\"], [\"lines\", \"none\"], [\"fill\", \"clear\", \"size\", \"small\", \"slot\", \"start\"], [\"elseTemplate\", \"\"], [\"size\", \"small\", \"slot\", \"end\"], [\"name\", \"star\", 1, \"text-yellow\"], [\"name\", \"star\"], [\"animated\", \"\"], [2, \"display\", \"flex\", \"margin-top\", \"5px\", \"margin-bottom\", \"5px\"], [2, \"width\", \"50%\", \"margin-left\", \"11px\"], [\"style\", \"position: relative;height: 200px;\", 4, \"ngIf\"], [2, \"position\", \"relative\", \"height\", \"200px\"], [1, \"ion-text-center\", 2, \"font-size\", \"1.5em\", \"position\", \"absolute\", \"top\", \"0\", \"bottom\", \"0\", \"right\", \"0\", \"left\", \"0\", \"text-align\", \"center\", \"margin\", \"auto\", \"height\", \"40px\"]],\n    template: function HistoryPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-content\", 0)(1, \"ion-card\", 1)(2, \"ion-card-content\", 2)(3, \"ion-title\", 3);\n        i0.ɵɵtext(4, \"Historial\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(5, HistoryPage_ng_container_5_Template, 5, 2, \"ng-container\", 4);\n        i0.ɵɵtemplate(6, HistoryPage_ng_template_6_Template, 1, 1, \"ng-template\", null, 5, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(7);\n\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.orders.length > 0)(\"ngIfElse\", _r1);\n      }\n    },\n    dependencies: [i6.NgForOf, i6.NgIf, i7.IonButton, i7.IonCard, i7.IonCardContent, i7.IonContent, i7.IonIcon, i7.IonInfiniteScroll, i7.IonInfiniteScrollContent, i7.IonItem, i7.IonSkeletonText, i7.IonTitle, i6.TitleCasePipe, i8.DateLocalPipe],\n    styles: [\".text-yellow[_ngcontent-%COMP%]{color:#c6c73a}.button-green[_ngcontent-%COMP%]{--background: green;color:#fff}.text-green[_ngcontent-%COMP%]{color:green}.button-red[_ngcontent-%COMP%]{--background: red;color:#fff}.text-red[_ngcontent-%COMP%]{color:red}.button-gray[_ngcontent-%COMP%]{--background: #CE4257;color:#ce4257}.button-cancel[_ngcontent-%COMP%]{--background: #95B2B0;color:#95b2b0}.button-dark[_ngcontent-%COMP%]{--background: #0e0f0f;color:#fff}\"]\n  });\n  return HistoryPage;\n})();","map":null,"metadata":{},"sourceType":"module"}