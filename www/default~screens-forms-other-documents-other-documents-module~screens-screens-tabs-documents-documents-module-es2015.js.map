{"version":3,"sources":["./src/app/screens/forms/other-documents/other-documents.page.html","./src/app/screens/forms/other-documents/other-documents.page.scss","./src/app/screens/forms/other-documents/other-documents.page.ts"],"names":[],"mappings":"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","file":"default~screens-forms-other-documents-other-documents-module~screens-screens-tabs-documents-documents-module-es2015.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar color=\\\"primary\\\" style=\\\"position: relative;\\\" mode=\\\"ios\\\">\\n    <ion-title style=\\\"position: absolute; left: 5px;bottom:14px\\\">Otros\\n    </ion-title>\\n    <ion-button (click)=\\\"dismiss()\\\" style=\\\"position: absolute; right: 5px;bottom:5px\\\">\\n      <ion-icon slot=\\\"icon-only\\\" name=\\\"close-outline\\\"></ion-icon>\\n    </ion-button>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <ng-container *ngIf=\\\"!img; else elseTemplate\\\">\\n    <form [formGroup]=\\\"document_information\\\">\\n      <ion-item lines=\\\"none\\\" class=\\\"input-text ion-margin-top\\\">\\n        <ion-select placeholder=\\\"Tipo de documento\\\" formControlName=\\\"document_type\\\" style=\\\"display: contents;\\\" required\\n          [selectedText]=\\\"document.name\\\">\\n          <ion-select-option *ngFor=\\\"let item of documents\\\" [value]=\\\"item.id\\\">{{item.name }}</ion-select-option>\\n        </ion-select>\\n      </ion-item>\\n    </form>\\n  </ng-container>\\n  <ng-template #elseTemplate>\\n    <ion-img [src] = \\\"img.url\\\" style=\\\"width: 100%;height: 300px;\\\" (click)=\\\"getFile()\\\">\\n\\n    </ion-img>\\n  </ng-template>\\n\\n\\n  <ion-button (click)=\\\"getFile()\\\" expand=\\\"block\\\" mode=\\\"ios\\\" color=\\\"primary\\\" class=\\\"ion-margin-bottom\\\">\\n    Subir documento\\n  </ion-button>\\n</ion-content>\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3NjcmVlbnMvZm9ybXMvb3RoZXItZG9jdW1lbnRzL290aGVyLWRvY3VtZW50cy5wYWdlLnNjc3MifQ== */\";","import { Component, OnInit, Input } from '@angular/core';\nimport { UiService } from 'src/app/services/ui.service';\nimport { Validators, FormBuilder } from '@angular/forms';\nimport { PhotoService } from 'src/app/services/photo.service';\nimport { AuthService } from 'src/app/services/auth.service';\nimport { RequestService } from 'src/app/services/request.service';\n\nimport { NetworkStatusService } from 'src/app/services/network-status.service';\n\n@Component({\n  selector: 'app-other-documents',\n  templateUrl: './other-documents.page.html',\n  styleUrls: ['./other-documents.page.scss'],\n})\nexport class OtherDocumentsPage implements OnInit {\n  @Input() documents: any[]\n  document: any = {\n    id: \"\",\n    name: \"\"\n  }\n\n  @Input() others: any[]\n\n  @Input() img: any\n\n\n  document_information = this.fb.group({\n    document_type: ['', Validators.required],\n  },\n  );\n  other_documents: any[] = []\n  constructor(private ui: UiService, private fb: FormBuilder,\n    private photo: PhotoService,\n    private auth: AuthService,\n    private request: RequestService,\n    private network: NetworkStatusService\n  ) { }\n\n  async ngOnInit() {\n    if (this.img) {\n      this.document_information.setValue({\n        document_type: this.img[\"document_type_id \"]\n      })\n    } else {\n      if (this.network.getNetworkStatus().connected) {\n        const loader = await this.ui.loading(\"Por favor espere...\");\n        this.request.get('list/attributes?parameter_id=8').subscribe(async (res: any) => {\n          this.documents = res.data;\n          (await loader).dismiss();\n        }, async err => {\n          (await loader).dismiss();\n        })\n      } else {\n        this.ui.showToast(\"Verifique su conexión\")\n      }\n    }\n\n\n  }\n\n  dismiss() {\n    this.ui.dismiss()\n  }\n\n  async takePhoto() {\n    try {\n      if (this.network.getNetworkStatus().connected) {\n        await (await this.photo.selectImageSource());\n        this.photo.imageSubject.subscribe(image => {\n          const url = `driver/documents/${this.auth.user.id}/32`;\n          const dat = new Date().getTime();\n          const name_file1 = `${dat}_${this.auth.user.id}.${image.format}`;\n          const blob_image = this.photo.dataUrlToBlob(image.url);\n          const image_to_upload = this.photo.getFileImage(image.url, name_file1, image.format);\n          let data = new FormData();\n          data.append('photo', blob_image);\n          this.request.post(url, data).subscribe(async (res: any) => {\n            console.log(\"Este es el res\", res)\n            this.ui.showToast(\"Documento subido\", () => {\n              this.dismiss();\n            })\n          },\n            async (err: any) => {\n              if(err.status == 400){\n                const error = JSON.stringify(err.error);\n                const message = err.error.messages ? err.error.messages[0].length == 1 ? err.error.messages :err.error.messages[0] : 'No hay mensaje'\n                await this.ui.presentAlert({\n                  mode: 'ios',\n                  header: message,\n                  buttons: [\n                    {\n                      text: 'Aceptar',\n                      handler: () => { }\n  \n                    }\n                  ]\n                })\n              }\n              \n            })\n        })\n      } else {\n        this.ui.showToast(\"Verifique su conexión\")\n      }\n\n\n    } catch (err) {\n      console.log(\"Error\", err)\n    }\n\n  }\n\n  async getFile() {\n    if (this.document_information.valid) {\n      const { document_type } = this.document_information.value\n      if (this.network.getNetworkStatus().connected) {\n        await (await this.photo.selectImageSource());\n        this.photo.imageSubject.subscribe(async (image) => {\n          if (this.img) {\n            this.img.url = image.dataUrl;\n          }\n          const url = this.img ? `driver/update_documents/${this.img.document_id}` : `driver/documents/${this.auth.user.id}/${document_type}`;\n          let data = new FormData();\n          const dat = new Date().getTime();\n          const name_file1 = `${dat}_${this.auth.user.id}.${image.format}`;\n          const blob_image = this.photo.dataUrlToBlob(image.dataUrl);\n          const image_to_upload = this.photo.getFileImage(image.dataUrl, name_file1, image.format);\n          data.append('photo', blob_image);\n          const loader = await this.ui.loading(\"Por favor espere...\");\n          this.request.post(url, data).subscribe(async (res: any) => {\n            (await loader).dismiss()\n            if (this.img) {\n              const find = this.others.findIndex(o => o.document_id == this.img);\n              if (find != -1) {\n                this.others[find] = this.img;\n              }\n            } else {\n              this.others.push({\n                url: image.dataUrl,\n              })\n            }\n            await this.ui.presentAlert({\n              mode: 'ios',\n              header: '¡Archivo subido con éxito!',\n              buttons: [\n                {\n                  text: 'Aceptar',\n                  handler: () => { }\n                }\n              ]\n            })\n          }, async (err: any) => {\n            (await loader).dismiss()\n            if(err.status == 400){\n              const error = JSON.stringify(err.error);\n              const message = err.error.messages ? err.error.messages[0].length == 1 ? err.error.messages :err.error.messages[0] : 'No hay mensaje'\n              await this.ui.presentAlert({\n                mode: 'ios',\n                header: message,\n                buttons: [\n                  {\n                    text: 'Aceptar',\n                    handler: () => { }\n\n                  }\n                ]\n              })\n            }\n            console.log(\"Err\", err)\n          })\n        })\n      }else{\n        this.ui.showToast(\"Verifique su conexión\");  \n      }\n    }else{\n      this.ui.showToast(\"Debe escoger un tipo de documento\");\n    }\n  }\n\n}\n"],"sourceRoot":"webpack:///"}